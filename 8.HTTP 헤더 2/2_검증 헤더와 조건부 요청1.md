# 검증 헤더와 조건부 요청

캐시 유효 시간이 초과해서 서버에 다시 요청하면 두 가지 상황이 나타난다.
1. 서버에서 기존 데이터를 변경함 🤍 → 🖤
2. 서버에서 기존 데이터를 변경하지 않음 🤍 → 🤍

### 검증 헤더 추가
- 서버의 데이터가 변경 되지 않았고 클라이언트 데이터가 아직 유효하다는 걸 검증할 방법이 필요함.
- 응답시 **Last-Modified** 추가 (검증 헤더)
- 요청시 **if-modified-since** 추가 (조건부 요청)

- 응답시

| 브라우저 캐시                               |
|---------------------------------------|
| star.jpg                              |
| 60초 유효                                |
| **데이터 최종 수정일<br/>2020년 11월 10일 10:00:00** |

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 저장 ↑

| 클라이언트                                                        |
|--------------------------------------------------------------|
| GET/ star.jpg  |

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;요청  ↓  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ↑ 응답

| 서버                                                                                                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HTTP/1.1 200 OK<br/>Content-Type: image/jpeg<br/> cache-control: max-age=60 <br/> **Last-Modified: 2020년 11월 10일 10:00:00** <br/>Content-Length: 34012<br/> 블라블라 |


- 요청시

| 브라우저 캐시                               |
|---------------------------------------|
| star.jpg                              |
| 60초 유효                                |
| **데이터 최종 수정일<br/>2020년 11월 10일 10:00:00** |

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 캐시 조회 ↓

| 클라이언트                                                        |
|--------------------------------------------------------------|
| GET/ star.jpg <br/>**if-modified-since: 2020년 11월 10일 10:00:00** |

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;요청  ↓  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ↑ 응답 (http body가 없음)

| 서버                                                                                                                                                                 |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HTTP/1.1 304 Not Modified <br/>Content-Type: image/jpeg<br/> cache-control: max-age=60 <br/> **Last-Modified: 2020년 11월 10일 10:00:00** <br/>Content-Length: 34012  |









